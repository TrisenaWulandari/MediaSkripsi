<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css" rel="stylesheet" />
    <title>ATUR HASIL KUIS DAN EVALUASI</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js" charset="UTF-8"></script>

    <!-- CSS -->
    <link rel="stylesheet" href="/css/style.css" />

    <!-- ALert -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  </head>
  <body>
    <!-- Sidebar-->
    <div class="sidebar">
      <div class="logo-details">
        <i class="bx bxs-magnet"></i>
        <span class="logo_name">Daftar Isi</span>
      </div>
      <ul class="nav-links">
        <li>
          <a href="home.html">
            <i class="bx bx-home"></i>
            <span class="link_name">Home</span>
          </a>
          <ul class="sub-menu blank">
            <li><a class="link_name" href="home.html">Home</a></li>
          </ul>
        </li>
        <li>
          <a href="HalamanGuru.html">
            <i class="bx bx-data"></i>
            <span class="link_name">Data Siswa</span>
          </a>
          <ul class="sub-menu blank">
            <li><a class="link_name" href="HalamanGuru.html">Data Siswa</a></li>
          </ul>
        </li>
        <li>
          <a href="TugasSiswa.html">
            <i class="bx bx-task"></i>
            <span class="link_name">Latihan Siswa</span>
          </a>
          <ul class="sub-menu blank">
            <li><a class="link_name" href="TugasSiswa.html">Latihan Siswa</a></li>
          </ul>
        </li>
        <li>
          <a href="HasilLembarSiswa.html">
            <i class="bx bxs-bookmark"></i>
            <span class="link_name">Hasil Lembar Siswa</span>
          </a>
          <ul class="sub-menu blank">
            <li><a class="link_name" href="HasilLembarSiswa.html">Hasil Lembar Siswa</a></li>
          </ul>
        </li>
        <li>
          <a href="HasilPengamatan.html">
            <i class="bx bx-bookmarks"></i>
            <span class="link_name">Hasil Belajar</span>
          </a>
          <ul class="sub-menu blank">
            <li><a class="link_name" href="Hasilpengamatan.html">Hasil Belajar</a></li>
          </ul>
        </li>
        <li>
          <a href="Aturkkm.html">
            <i class="bx bx-bookmarks"></i>
            <span class="link_name">Atur KKM</span>
          </a>
          <ul class="sub-menu blank">
            <li><a class="link_name" href="Aturkkm.html">Atur KKM</a></li>
          </ul>
        </li>
        <li>
          <div class="profile-details">
            <div class="profile-content">
              <img src="/img/user.png" alt="profileImg" />
            </div>
            <div class="nama-nip">
              <div id="userInp" class="nama">
                <div id="nip" class="nip"></div>
              </div>
            </div>
            <i class="bx bx-log-out" href="home.html"></i>
          </div>
        </li>
      </ul>
    </div>
    <!-- Akhir Sidebar -->

    <!-- ======= About Section ======= -->
    <!-- Header -->
    <section class="home-section">
      <div class="home-content">
        <i class="bx bx-menu"></i>
        <span class="text">PENGATURAN KKM KUIS DAN EVALUASI</span>
      </div>

      <!--  Container isi  -->
      <div id="content">
        <div class="container-fluid shadow">
          <div class="isi">
            <div>
              <center><h2>Hasil Kuis dan Evaluasi</h2></center>
            </div>
            <div class="container">
              <div class="table-responsive">
                <table class="table table-bordered table-sm">
                  <thead class="table table-bordered" style="background-color: #73a9cc; color: black">
                    <tr>
                      <th class="text-center" scope="col">Nomor</th>
                      <th class="text-center" scope="col">Atur KKM Kuis atau Evaluasi</th>

                      <th class="text-center" scope="col">KKM Saat Ini</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr style="background-color: #6e94ca; color: black">
                      <th class="text-center" scope="row">1</th>
                      <td>
                        <button type="button" class="btn btn-light" data-bs-toggle="modal" data-bs-target="#modalKuis1" style="background-color: #f9ba9b; border-radius: 5px; color: black">
                          <i class="fa-solid fa-pen-to-square"></i>&nbsp;Atur
                        </button>
                        Kuis 1
                      </td>
                      <td>
                        <center><div class="kkm1"></div></center>
                      </td>
                    </tr>
                    <tr style="background-color: #6e94ca; color: black">
                      <th class="text-center" scope="row">2</th>
                      <td>
                        <button type="button" class="btn btn-light" data-bs-toggle="modal" data-bs-target="#modalKuis2" style="background-color: #f9ba9b; border-radius: 5px; color: black">
                          <i class="fa-solid fa-pen-to-square"></i>&nbsp;Atur
                        </button>
                        Kuis 2
                      </td>
                      <td>
                        <center><div class="kkm2"></div></center>
                      </td>
                    </tr>
                    <tr style="background-color: #6e94ca; color: black">
                      <th class="text-center" scope="row">3</th>
                      <td>
                        <button type="button" class="btn btn-light" data-bs-toggle="modal" data-bs-target="#modalKuis3" style="background-color: #f9ba9b; border-radius: 5px; color: black">
                          <i class="fa-solid fa-pen-to-square"></i>&nbsp;Atur
                        </button>
                        kuis 3
                      </td>
                      <td>
                        <center><div class="kkm3"></div></center>
                      </td>
                    </tr>
                    <tr style="background-color: #6e94ca; color: black">
                      <th class="text-center" scope="row">4</th>
                      <td>
                        <button type="button" class="btn btn-light" data-bs-toggle="modal" data-bs-target="#modalEvaluasi" style="background-color: #f9ba9b; border-radius: 5px; color: black">
                          <i class="fa-solid fa-pen-to-square"></i>&nbsp;Atur
                        </button>
                        Evaluasi
                      </td>
                      <td>
                        <center><div class="kkm4"></div></center>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <br />
            </div>

            <!-- Modal Kuis 1-->
            <div class="modal fade" id="modalKuis1" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header" style="background-color: #39577c">
                    <h5 class="modal-title text-white" id="staticBackdropLabel">Edit KKM Kuis 1</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                    <!-- <button type="button" class="close text-white" data-bs-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button> -->
                  </div>
                  <div class="modal-body" style="background-color: #bcd6e7">
                    <div class="form-group row">
                      <label for="inputEmail3" class="col-sm-2 col-form-label">KKM</label>
                      <div class="col-sm-10">
                        <input type="number" class="form-control editKKM1" id="kkm1" />
                      </div>
                    </div>
                  </div>
                  <div class="modal-footer" style="background-color: #39577c">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn" style="background-color: #bcd6e7; color: black" id="setKKM1" data-bs-dismiss="modal">Simpan</button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Modal Kuis 2-->
            <div class="modal fade" id="modalKuis2" data-backdrop="static" data-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header" style="background-color: #39577c">
                    <h5 class="modal-title text-white" id="staticBackdropLabel">Edit KKM Kuis 2</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body" style="background-color: #bcd6e7">
                    <div class="form-group row">
                      <label for="inputEmail3" class="col-sm-2 col-form-label">KKM</label>
                      <div class="col-sm-10">
                        <input type="number" class="form-control editKKM2" id="kkm2" />
                      </div>
                    </div>
                  </div>
                  <div class="modal-footer" style="background-color: #39577c">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn" style="background-color: #bcd6e7; color: black" id="setKKM2" data-bs-dismiss="modal">Simpan</button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Modal Kuis 3-->
            <div class="modal fade" id="modalKuis3" data-backdrop="static" data-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header" style="background-color: #39577c">
                    <h5 class="modal-title text-white" id="staticBackdropLabel">Edit KKM Evaluasi</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body" style="background-color: #bcd6e7">
                    <div class="form-group row">
                      <label for="inputEmail3" class="col-sm-2 col-form-label">KKM</label>
                      <div class="col-sm-10">
                        <input type="number" class="form-control editKKM3" id="kkm3" />
                      </div>
                    </div>
                  </div>
                  <div class="modal-footer" style="background-color: #39577c">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn" style="background-color: #bcd6e7; color: black" id="setKKM3" data-bs-dismiss="modal">Simpan</button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Modal Evaluasi-->
            <div class="modal fade" id="modalEvaluasi" data-backdrop="static" data-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header" style="background-color: #39577c">
                    <h5 class="modal-title text-white" id="staticBackdropLabel">Edit KKM Evaluasi</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body" style="background-color: #bcd6e7">
                    <div class="form-group row">
                      <label for="inputEmail3" class="col-sm-2 col-form-label">KKM</label>
                      <div class="col-sm-10">
                        <input type="number" class="form-control editKKM5" id="kkm4" />
                      </div>
                    </div>
                  </div>
                  <div class="modal-footer" style="background-color: #39577c">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn" style="background-color: #bcd6e7; color: black" id="setKKM5" data-bs-dismiss="modal">Simpan</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <script>
      let arrow = document.querySelectorAll(".arrow");
      for (var i = 0; i < arrow.length; i++) {
        arrow[i].addEventListener("click", (e) => {
          let arrowParent = e.target.parentElement.parentElement; //selecting main parent of arrow
          arrowParent.classList.toggle("showMenu");
        });
      }
      let sidebar = document.querySelector(".sidebar");
      let sidebarBtn = document.querySelector(".bx-menu");
      console.log(sidebarBtn);
      sidebarBtn.addEventListener("click", () => {
        sidebar.classList.toggle("close");
      });
    </script>
    <script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.19.1/firebase-app.js";
      import { getDatabase, ref, child, set, get, update, remove, onChildAdded, onValue, push, query } from "https://www.gstatic.com/firebasejs/9.19.1/firebase-database.js";

      // For Firebase JS SDK v7.20.0 and later, measurementId is optional
      const firebaseConfig = {
        apiKey: "AIzaSyCplY14r_usHBnV0q4fN9yLFB17F0rFcY4",
        authDomain: "skripsi-1ebb7.firebaseapp.com",
        databaseURL: "https://skripsi-1ebb7-default-rtdb.firebaseio.com",
        projectId: "skripsi-1ebb7",
        storageBucket: "skripsi-1ebb7.appspot.com",
        messagingSenderId: "95532009828",
        appId: "1:95532009828:web:692b1f60263f77340ad271",
        measurementId: "G-2X999JFXEX",
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const db = getDatabase();

      //referensi//
      let namalink = document.getElementById("userInp");
      let nama = sessionStorage.getItem("nama");
      namalink.innerText = nama;

      // let niplink = document.getElementById("nip");
      // let nip = sessionStorage.getItem("nip");
      // niplink.innerText = nip;
      // // var currentUser = null;

      //Atur kkm
      let idnya = [];

      onValue(ref(db, "kkm"), (snapshot) => {
        handleSuccess(snapshot);
      });

      // let getKKM;
      function handleSuccess(items) {
        let getKKM = items.val();

        let kkm1 = getKKM[1]["kkm"];
        let kkm2 = getKKM[2]["kkm"];
        let kkm3 = getKKM[3]["kkm"];
        let kkm4 = getKKM[4]["kkm"];

        var kkm1html = document.querySelector(".kkm1");
        kkm1html.innerHTML = kkm1;

        var editkkm1 = document.querySelector(".editKKM1");
        editkkm1.value = kkm1;

        var kkm2html = document.querySelector(".kkm2");
        kkm2html.innerHTML = kkm2;

        var editkkm2 = document.querySelector(".editKKM2");
        editkkm2.value = kkm2;

        var kkm3html = document.querySelector(".kkm3");
        kkm3html.innerHTML = kkm3;

        var editkkm3 = document.querySelector(".editKKM3");
        editkkm3.value = kkm3;

        var kkm4html = document.querySelector(".kkm4");
        kkm4html.innerHTML = kkm4;

        var editkkm4 = document.querySelector(".editKKM4");
        editkkm4.value = kkm4;
      }

      function handleError(eror) {
        console.log(eror);
      }

      setKKM1.addEventListener("click", (e) => {
        const db = getDatabase();
        const kkminput = document.getElementById("kkm1").value;

        // var task = {
        //   id: 0,
        //   kkm: kkminput,
        // };
        //
        // let database = ref(db, "kkm/" + 0);
        // database.set(task);

        set(ref(db, "kkm/" + 1), {
          id: 0,
          kkm: kkminput,
        });
      });

      setKKM2.addEventListener("click", (e) => {
        const kkminput = document.getElementById("kkm2").value;
        const db = getDatabase();

        set(ref(db, "kkm/" + 2), {
          id: 0,
          kkm: kkminput,
        });
      });

      setKKM3.addEventListener("click", (e) => {
        const kkminput = document.getElementById("kkm3").value;
        const db = getDatabase();

        set(ref(db, "kkm/" + 3), {
          id: 0,
          kkm: kkminput,
        });
      });

      setKKM4.addEventListener("click", (e) => {
        const kkminput = document.getElementById("kkm4").value;
        const db = getDatabase();

        set(ref(db, "kkm/" + 4), {
          id: 0,
          kkm: kkminput,
        });
      });

      // Function panggil nama;
      function getNama() {
        if (nama == null) {
          window.location = "LoginGuru.html";
        } else {
          userlink.innerText = nama;
        }
      }

      function getNip() {
        if (nip == null) {
          window.location = "LoginGuru.html";
        } else {
          niplink.innerText = nip;
        }
      }

      // getNama();
      // getNip();

      //Akhir Menampilkan Nama Guru
      function LogOut() {
        sessionStorage.removeItem("nama");

        window.location = "index.html";
      }
    </script>
    <!-- <script type="module" src="/js/aturkkm.js"></script> -->
  </body>
</html>
